<templates xml:space="preserve">
  <t t-name="test_relationship.TestRelationshipTemplate">
    <div class="oe_structure container my-4">
      <div class="card shadow-sm">
        <div class="card-body">
          <!-- Title -->
          <h2 class="card-title mb-4 text-primary text-center fw-bold display-5">
            üìã Danh s√°ch test Records
          </h2>
          
          <!-- Thanh l·ªçc 1 d√≤ng: Select | Input | Button -->
          <!-- V√πng l·ªçc t·ªïng -->
          <div class="d-flex justify-content-center my-4">
            <div class="d-flex w-75 gap-3">

              <!-- Dropdown field -->
              <div class="dropdown">
                <button class="btn btn-outline-secondary dropdown-toggle btn-lg"
                        data-bs-toggle="dropdown"
                        aria-expanded="false">
                  <t t-esc="state.filterField"/>
                </button>
                <ul class="dropdown-menu">
                  <li><a class="dropdown-item" href="#" t-on-click="() => this.setFilterField('name')">name</a></li>
                </ul>
              </div>

              <!-- √î nh·∫≠p t·ª´ kh√≥a (chi·∫øm 100% c√≤n l·∫°i) -->
              <input type="text"
                    class="form-control form-control-lg flex-grow-1"
                    placeholder="Nh·∫≠p t·ª´ kh√≥a t√¨m ki·∫øm..."
                    t-model="state.filterValue"/>

              <!-- N√∫t t√¨m -->
              <button class="btn btn-primary btn-lg"
                      t-on-click="applyFilters">üîç</button>
            </div>
          </div>


          <!-- N√∫t t·∫°o m·ªõi -->
          <div class="mb-3 d-flex justify-content-between">
            <button class="btn btn-primary" 
                    t-on-click="openCreateModal">‚ûï T·∫°o m·ªõi</button>
          </div>
          

          <!-- Danh s√°ch items -->
          <t t-if="state.items.length">
            <ul class="list-group mb-3">
                <t t-foreach="state.items" t-as="item" t-key="item.id">
                  <li class="list-group-item d-flex flex-column flex-md-row justify-content-between align-items-start align-items-md-center gap-2">
                    
                    <!-- Hi·ªÉn th·ªã 1 item  -->
                    <div class="d-flex align-items-start gap-3">

                      <!-- Th√¥ng tin: checkbox, name, title -->
                      <div class="form-check d-flex flex-column">
                        <div class="d-flex align-items-center">
                          <label class="form-check-label fw-semibold mb-0">
                            <t t-esc="item.name"/>
                          </label>
                        </div>
                      </div>

                    </div>
                  </li>
                </t>
            </ul>
          </t>

          <!-- Pagination -->
          <div class="d-flex justify-content-center">
            <ul class="pagination pagination-lg mb-0">
              <!-- N√∫t ¬´ v·ªÅ trang tr∆∞·ªõc -->
              <li t-att-class="state.page === 1 ? 'page-item disabled' : 'page-item'">
                <a href="#" class="page-link" t-on-click="() => this.goToPage(state.page - 1)">¬´</a>
              </li>

              <t t-set="totalPages" t-value="Math.ceil(state.total / state.pageSize)"/>
              <t t-set="maxPages" t-value="5"/>
              <t t-set="startPage"
                t-value="Math.max(1, Math.min(state.page - 2, totalPages - maxPages + 1))"/>
              <t t-set="endPage"
                t-value="Math.min(startPage + maxPages - 1, totalPages)"/>

              <!-- Danh s√°ch c√°c trang ƒë∆∞·ª£c hi·ªÉn th·ªã -->
              <t t-foreach="Array.from({length: endPage - startPage + 1}, (_, i) => startPage + i)" t-as="p" t-key="p">
                <li t-att-class="p === state.page ? 'page-item active' : 'page-item'">
                  <a href="#" class="page-link" t-on-click="() => this.goToPage(p)">
                    <t t-esc="p"/>
                  </a>
                </li>
              </t>

              <!-- N√∫t ¬ª t·ªõi trang ti·∫øp -->
              <li t-att-class="state.page === totalPages ? 'page-item disabled' : 'page-item'">
                <a href="#" class="page-link" t-on-click="() => this.goToPage(state.page + 1)">¬ª</a>
              </li>
            </ul>
          </div>

          <!-- N·∫øu kh√¥ng c√≥ b·∫£n ghi -->
          <t t-if="!state.items.length">
            <p class="text-muted">Kh√¥ng c√≥ b·∫£n ghi n√†o.</p>
          </t>

          <!-- Modal T·∫°o m·ªõi -->
          <div t-if="state.isCreateModal" class="modal d-block" style="background: rgba(0,0,0,0.5);">
            <div class="modal-dialog modal-dialog-centered">
              <div class="modal-content">
                <div class="modal-header">
                  <h5 class="modal-title">T·∫°o m·ªõi</h5>
                  <button type="button" class="btn-close" t-on-click="closeCreateModal"></button>
                </div>
                <div class="modal-body d-flex flex-column gap-3">
                  <label>T√™n</label>
                  <input type="text" class="form-control" t-model="state.newName" />
                </div>
                <div class="modal-footer">
                  <button class="btn btn-secondary" t-on-click="closeCreateModal">H·ªßy</button>
                  <button class="btn btn-primary" t-on-click="addItem">L∆∞u</button>
                </div>
              </div>
            </div>
          </div>

        </div>
      </div>
    </div>
  </t>
</templates>

